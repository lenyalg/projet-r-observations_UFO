---
title: ""
date: "`r format(Sys.Date(), '%d %B %Y')`"
output: 
  html_document:
    theme: yeti
    toc: true
    toc_float: true
    number_sections: false
    code_folding: hide
    self_contained: true
---

<style>
.title-page {
  font-family: sans-serif;
  text-align: center;
  padding: 20px;
  border-bottom: 2px solid #eee;
  margin-bottom: 40px;
}
.logo-container {
  display: flex;
  justify-content: center;
  align-items: center;
  margin-bottom: 30px;
}
.logo-container img {
  max-width: 150px;
  height: auto;
}
.title-page h1 {
  font-weight: bold;
}
.title-page h3 {
  color: #555;
  font-weight: 300;
}
.title-page .course-info {
  margin-top: 40px;
  font-size: 1.1em;
  color: #333;
}
</style>

<div class="title-page">

<div class="logo-container">
  <img src="logoUniv.png" alt="Logo Université">
  <img src="logoPolytech.png" alt="Logo Polytech">
</div>

<h1>Rapport statistique détaillé sur les observations d’OVNIs en Amérique</h1>

<div class="course-info">
<strong>R et Dataviz</strong><br>
<strong>DaMS 3 - Année universitaire 2025-2026</strong><br>
</div>

<img src="DAMS.png" alt="logo DaMS" style="margin-top: 12px;">

<div style="font-size: 1.3em; font-weight: 600; margin-top: 25px; margin-bottom: 10px;">
  Réalisé par :
</div>

<div style="font-size: 1.2em; line-height: 1.6;">
  Leny SOULARD<br>
  Kevin MIEVRE<br>
  Massyl HELLI<br>
  Leny ALGUAZIL
</div>

</div>



# Chargement des données

```{r echo=TRUE, message = FALSE, warning=FALSE, out.width='100%', fig.width=12, fig.height=7}
library("ggplot2")
library(readr)
library(janitor)
library(lubridate)
library(stringr)
library(forcats)
library(dplyr)
library(patchwork)
library(DT)
library(plotly)


data_path <- "data/complete.csv"

raw_data <- readr::read_csv(data_path, 
                            col_types = cols(.default = "c"))


ufo_data <- raw_data %>%
  janitor::clean_names() %>%

  mutate(
    latitude = as.numeric(latitude),
    longitude = as.numeric(longitude),
    duration_seconds = as.numeric(duration_seconds),

    datetime = lubridate::mdy_hm(datetime)
  ) %>%

  filter(
    !is.na(datetime),         
    !is.na(latitude),         
    !is.na(longitude),
    !is.na(shape),            
    !is.na(duration_seconds)
  ) %>%

  filter(
    country == "us",
    lubridate::year(datetime) >= 1949
  ) %>%
  
  filter(
    duration_seconds > 0,
    duration_seconds < (3600 * 24)
  ) %>%

  mutate(
    year = lubridate::year(datetime),
    month = lubridate::month(datetime, label = TRUE, abbr = FALSE),
    hour = lubridate::hour(datetime),
    weekday = lubridate::wday(datetime, label = TRUE, abbr = FALSE),

    time_of_day = case_when(
      hour >= 6 & hour < 12 ~ "Matin (06-12h)",
      hour >= 12 & hour < 18 ~ "Après-midi (12-18h)",
      hour >= 18 & hour < 22 ~ "Soirée (18-22h)",
      TRUE ~ "Nuit (22-06h)"
    )
  ) %>%

  mutate(
    state = toupper(state),
    shape = tolower(shape),
    shape = case_when(
      shape %in% c("round", "sphere") ~ "circle",
      shape %in% c("lights") ~ "light",
      shape %in% c("cigar-shaped") ~ "cigar",
      shape %in% c("fireball", "flare") ~ "fireball",
      TRUE ~ shape
    ),
    shape = forcats::fct_lump_n(shape, n = 10, other_level = "Other")
  ) %>%

  select(
    datetime, year, month, hour, weekday, time_of_day,
    city, state, latitude, longitude,
    shape, duration_seconds, comments
  )
```


# Introduction

Bilan statistique des signalements d’OVNIs

Contexte
Ce rapport s’appuie sur une analyse exploratoire des données (AED) réalisée à partir d’un jeu de données disponible sur Kaggle et issu des archives du National UFO Reporting Center (NUFORC). Il contient plus de 80 000 déclarations d’observations d’OVNIs sur une longue période.
L’objectif est d’utiliser R et ses outils afin de transformer ces données brutes en indicateurs utiles et mettre en évidence certaines tendances.

L’analyse cherche à dresser un portrait statistique des signalements selon le temps, la localisation et la description des phénomènes, sans tirer de conclusions sur leur origine. Cependant nous emmetrons certaines hypothèses qui pourraient expliquer certains résultats.

Structure du jeu de données
Le fichier contient plusieurs colonnes essentielles pour l’analyse. Certaines devront être nettoyées au préalable afin d’assurer une meilleure compréhension des données et d’obtenir des résultats plus fiables.


```{r table-description-colonnes, echo=FALSE, message=FALSE, warning=FALSE, out.width='100%'}
library(knitr)
library(dplyr)
library(kableExtra)

description_colonnes <- tibble(
  Variable = c("datetime", "city", "state", "country", "shape", 
               "duration (seconds)", "duration (hours/min)", "comments", 
               "date posted", "latitude", "longitude"),
  Description = c("Date et heure précises de l'observation (Base de l'analyse chronologique).", 
                  "Nom de la ville.", 
                  "Abréviation de l'État (principalement US).", 
                  "Code du pays (ex. : 'us').", 
                  "Forme de l'objet rapporté. Variable catégorielle clé.", 
                  "Durée de l'observation en secondes. Sujette à un nettoyage rigoureux.", 
                  "Durée fournie dans son format original.", 
                  "Description narrative détaillée de l'événement.", 
                  "Date d'enregistrement du rapport.", 
                  "Coordonnée de latitude (pour la cartographie).", 
                  "Coordonnée de longitude (pour la cartographie).")
)

kable(description_colonnes, 
      caption = "Structure détaillée du jeu de données des observations d'OVNIs.",
      col.names = c("Variable", "Description/Rôle Clé"),
      align = 'lc',
      booktabs = TRUE) %>%
  kable_styling(full_width = FALSE, 
                latex_options = "striped",
                bootstrap_options = c("striped", "hover", "condensed")) %>%
  row_spec(0, background = "#ecf0f1", color = "black")
```

```{r echo=FALSE, message = FALSE, warning=FALSE}
datatable(ufo_data[1:10, ],
          options = list(
              dom = 't',       
              scrollX = TRUE   
          ),
          class = 'compact nowrap',
          rownames = FALSE
)
```

La taille de la population de la base de données est d'environ 80 000 individus et couvre une période allant de 1949 à 2014.


# Analyse Temporelle {.tabset}

Nous nous sommes dans un premier temps demandé comment le nombre d'observations évolue dans le temps au vu du nombre d'années disponible dans nos données. Pour rester dans une analyse temporelle, nous avons ensuite décidé de voir si au cours d'une année le nombre varie selon les mois, mais aussi si le nombre varie en fonction de l'heure de la journée.

## Par Année

```{r plot-year, echo=FALSE, message = FALSE, warning=FALSE, out.width='100%', fig.width=10, fig.height=6}

ufo_data_summary_year <- ufo_data %>%  group_by(year) %>%  summarise(n = n(), .groups = 'drop')

ggplot(ufo_data_summary_year, aes(x = as.factor(year), y = n)) +  geom_col(fill = "#007bff") + 
  labs(    title = "Nombre d'observations par Année",
    x = "Année",    y = "Nombre d'observations (n)"  ) +
  theme_minimal(base_size = 12) + 
  theme(axis.text.x = element_text(angle = 60, hjust = 1, size = 8))
```

Avec ce premier graphique, on voit bien que depuis le début des années 2000, le nombre d'observations explose. Cela peut être dû à plusieurs facteurs comme la potentielle facilité de rapporter une observation avec les nouvelles technologies émergentes ou encore la culture populaire qui aide à rendre ce sujet acceptable socialement.

## Par Mois et Heure

```{r plot-month-hour, echo=FALSE, message = FALSE, warning=FALSE, out.width='100%', fig.width=12, fig.height=6}
ufo_data_summary_month <- ufo_data %>%  group_by(month) %>%  summarise(n = n(), .groups = 'drop')

p1 <- ggplot(ufo_data_summary_month, aes(x = month, y = n)) +
  geom_col(fill = "#007bff") + 
  labs(    title = "Nombre d'observations par Mois",    x = "Mois", y = "Nombre d'observations (n)"  ) + 
  theme_minimal(base_size = 12) + 
  theme(axis.text.x = element_text(angle = 45, hjust = 1))

ufo_data_summary_hour <- ufo_data %>%  group_by(hour) %>%  summarise(n = n(), .groups = 'drop')

p2 <- ggplot(ufo_data_summary_hour, aes(x = as.factor(hour), y = n)) +  geom_col(fill = "#5bc0de") + 
  labs(    title = "Nombre d'observations par Heure",    x = "Heure de la journée", y = "Nombre d'observations (n)"  ) + 
  theme_minimal(base_size = 12)

p1 + p2
```

Grâce à ces deux graphiques, on peut voir que le nombre d'observations varie bien selon le mois et l'heure de la journée. De même que pour les variations au cours des années, on peut expliquer cela par plusieurs facteurs. En premier lieu, les observations sont plus courantes durant la nuit ce qui peut être expliqué par le fait que la nuit les lumières sont plus visibles et nous avons moins de repères visuels avec le manque de lumière naturelle. En deuxième lieu, on peut voir que durant l'été il y a une hausse plutôt importante d'observations qui peut être expliquée par le fait que les gens vont avoir tendance à être plus dehors lorsque la météo le permet et que les journées sont plus longues.

# Analyse Temporelle détaillée
Nous avons voulu avoir une vision plus précise encore en fonction des jours et des heures pour les apparitions. Pour ce faire nous avons créé une heatmap qui nous résume parfaitement les apparitions.

```{r}
    heatmap_data <- ufo_data |>
      mutate(wday_label = wday(datetime, label = TRUE, abbr = TRUE, week_start = 1),
             hour_val = hour(datetime)) |>
      count(wday_label, hour_val)
    
    p <- ggplot(heatmap_data, aes(x = hour_val, y = wday_label, fill = n)) +
      geom_tile(color = "white") +
      scale_fill_viridis_c(option = "plasma") +
      theme_minimal(base_size = 12) +
      labs(x = "Heure (00h-23h)", y = "Jour", fill = "Nombre d'observations") +
      scale_x_continuous(breaks = seq(0, 23, 2))
    
    ggplotly(p) |> config(displayModeBar = FALSE)
  
```


# Analyse des Formes
Une des choses qui interpelle le plus quand on parle d'OVNI peut notamment être la forme sous laquelle l'OVNI a été observé. Bien que nous ayons un grand nombre d'individus dans notre base de données, on retrouve de nombreuses fois les mêmes formes ou le même type de forme comme : une lumière, un rond ou une sphère, un triangle, un cigare et encore quelques autres. Pour faciliter l'analyse nous avons regroupé certaines formes ensemble quand celles-ci sont quasiment similaires.

```{r plot-shape, echo=FALSE, message = FALSE, warning=FALSE, out.width='100%', fig.width=10, fig.height=6}
ufo_data %>%  count(shape, sort = TRUE) %>%  ggplot(aes(x = fct_reorder(shape, n), y = n)) +
  geom_col(fill = "#007bff") + 
  labs(    title = "Formes les plus observées",     x = "Forme",     y = "Nombre d'observations (n)"  ) + 
  theme_minimal(base_size = 12) + 
  coord_flip() 
# coord_flip est souvent meilleur pour les graphiques en barres avec beaucoup de catégories
```

# Conclusion

L'analyse de cet ensemble de données révèle des tendances claires. L'augmentation des observations au fil du temps, en particulier depuis les années 2000, suggère une influence culturelle et technologique. Les observations sont plus fréquentes la nuit et en été, ce qui correspond à des périodes où les gens sont plus susceptibles d'être à l'extérieur et où les phénomènes lumineux sont plus visibles. Enfin, la prédominance de formes simples comme "lumière", "cercle" et "triangle" domine les rapports, ce qui peut s'expliquer par la difficulté d'identifier des formes complexes à distance et dans l'obscurité.
